# ============================================
# üöÇ RAILWAY CONFIGURATION - Backend Only
# ============================================
# 
# Ce fichier configure le d√©ploiement du BACKEND uniquement
# Le frontend est d√©ploy√© sur Vercel (voir vercel.json)
#
# ============================================

[build]
builder = "NIXPACKS"
buildCommand = "npm install && npx prisma generate"

[deploy]
startCommand = "npx prisma migrate deploy && npm run start:prod"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[env]
NODE_ENV = "production"
PORT = { default = "3001" }
HOST = { default = "0.0.0.0" }

# ============================================
# HEALTH CHECK
# ============================================
[healthcheck]
path = "/api/health"
interval = 30
timeout = 10

# ============================================
# VARIABLES REQUISES (√† configurer dans Railway Dashboard)
# ============================================
# 
# üîê Secrets √† d√©finir manuellement :
# - GEMINI_API_KEY : Cl√© API Google Gemini (https://aistudio.google.com/app/apikey)
# - JWT_SECRET : Secret pour JWT (g√©n√©rer avec: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))")
# - FRONTEND_URL : URL Vercel frontend (ex: https://votre-app.vercel.app)
#
# üìä R√©f√©rences Railway √† connecter :
# - DATABASE_URL : Add Reference ‚Üí PostgreSQL
# - REDIS_URL : Add Reference ‚Üí Redis
#
# üîß Optionnelles :
# - LOG_LEVEL : debug | info | warn | error (d√©faut: info)
# - TWO_FACTOR_ISSUER : Nom pour 2FA (d√©faut: TransitGuin√©e)
#
# ============================================
