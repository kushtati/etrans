# Railway Deployment Configuration
# https://railway.app

# Build settings
[build]
  builder = "NIXPACKS"
  buildCommand = "npm install && npx prisma generate && npm run build"

# Start command  
[deploy]
  startCommand = "npx prisma migrate deploy && npm run start:prod"
  restartPolicyType = "ON_FAILURE"
  restartPolicyMaxRetries = 10

# Health check
[healthcheck]
  path = "/api/auth/csrf-token"
  interval = 30
  timeout = 10
  
# Environment detection
[env]
  NODE_ENV = "production"
